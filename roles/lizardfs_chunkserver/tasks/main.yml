---
- name: Kopiere Chunkserverkonfig
  become: true
  template:
    src: "{{ item }}.j2"
    dest: "/etc/mfs/{{ item }}"
    owner: root
    group: root
    mode: 0644
  with_items:
    - mfschunkserver.cfg
    - mfshdd.cfg
  notify: reload lizardfs-chunkserver
 
- name: Setze Berechtigungen mfshdd Verzeichnisse
  become: true
  file:
    path: "{{ item.mountpoint }}"
    owner: mfs
    group: mfs
    mode: 0755
  with_items: "{{ lizardfs.disks }}"

- name: Installiere lizardfs-chunkserver
  become: true
  apt:
    name: lizardfs-chunkserver
    state: present

- name: Aktiviere lizardfs-chunkserver als Service
  become: true
  template:
    src: lizardfs-chunkserver.j2
    dest: /etc/default/lizardfs-chunkserver
    mode: 0644
    force: yes

